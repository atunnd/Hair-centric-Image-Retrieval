# Part-Based DualViewHair Configuration
# Part-based semantic hair region learning with asymmetric NT-Xent

# Model Configuration
model:
  encoder_type: "partbased"         # Part-based encoder
  embedding_dim: 384                # Larger embedding for part fusion
  projection_dim: 128               # Contrastive projection dimension
  momentum: 0.999                   # Teacher momentum update rate
  pretrained: true                  # Use ImageNet pretrained backbone
  use_cross_alignment: false        # Part-based model handles alignment internally
  num_parts: 3                      # Number of hair parts (top, sides, back)

# Loss Configuration
loss:
  loss_type: "asymmetric_ntxent"    # Asymmetric NT-Xent for directional learning
  temperature: 0.05                 # Very low temperature for fine-grained distinctions
  weight_s2t: 1.0                   # Student-to-teacher weight
  weight_t2s: 0.3                   # Lower teacher-to-student weight

# Data Configuration
data:
  data_root: "./data"               # Root directory containing hair_regions and full_images
  image_size: 224                   # Input image size (square)
  normalize_mean: [0.485, 0.456, 0.406]  # ImageNet normalization
  normalize_std: [0.229, 0.224, 0.225]

# Training Configuration
training:
  num_epochs: 100                   # Longer training for part-based learning
  batch_size: 16                    # Smaller batch due to model complexity
  learning_rate: 0.0003             # Conservative learning rate
  weight_decay: 0.0002              # Higher regularization
  optimizer: "adamw"                # AdamW optimizer
  scheduler: "cosine"               # Cosine annealing
  warmup_epochs: 15                 # Extended warmup
  grad_clip_norm: 0.5               # Stricter gradient clipping
  
  # Logging and saving
  log_interval: 25                  # Frequent logging
  save_interval: 5                  # Save more frequently
  output_dir: "./outputs/partbased"  # Output directory

# Evaluation Configuration
evaluation:
  batch_size: 16                    # Small batch for complex model
  top_k: [1, 5, 10, 20, 50, 100]   # Extended evaluation
  metrics: ["map", "recall", "ndcg", "precision"]  # Comprehensive metrics
  use_teacher: true                 # Use teacher encoder for evaluation
